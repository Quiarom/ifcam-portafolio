---
---

<div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 sm:p-8">
  <h2 class="text-2xl font-bold mb-6 text-gray-900 dark:text-gray-100">Get In Touch</h2>
  
  <form id="contactForm" class="space-y-6">
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
      <div>
        <label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
          Nombre *
        </label>
        <input
          type="text"
          id="name"
          name="name"
          required
          class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-accent-light dark:focus:ring-accent-dark focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors"
          placeholder="Tu nombre completo"
        />
      </div>
      
      <div>
        <label for="email" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
          Email *
        </label>
        <input
          type="email"
          id="email"
          name="email"
          required
          class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-accent-light dark:focus:ring-accent-dark focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors"
          placeholder="tu@email.com"
        />
      </div>
    </div>
    
    <div>
      <label for="subject" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
        Asunto *
      </label>
      <input
        type="text"
        id="subject"
        name="subject"
        required
        class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-accent-light dark:focus:ring-accent-dark focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors"
        placeholder="¿En qué puedo ayudarte?"
      />
    </div>
    
    <div>
      <label for="message" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
        Mensaje *
      </label>
      <textarea
        id="message"
        name="message"
        rows="6"
        required
        class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-accent-light dark:focus:ring-accent-dark focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors resize-vertical"
        placeholder="Cuéntame sobre tu proyecto o consulta..."
      ></textarea>
    </div>
    
    <div>
      <button
        type="submit"
        id="submitBtn"
        class="w-full bg-accent-light dark:bg-accent-dark text-white font-medium py-3 px-6 rounded-lg hover:bg-accent-light/90 dark:hover:bg-accent-dark/90 focus:ring-2 focus:ring-accent-light dark:focus:ring-accent-dark focus:ring-offset-2 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
      >
        <span id="submitText">Enviar Mensaje</span>
        <span id="loadingText" class="hidden">Enviando...</span>
      </button>
    </div>
  </form>
  
  <!-- Success Message -->
  <div id="successMessage" class="hidden mt-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg">
    <div class="flex items-center">
      <svg class="w-5 h-5 text-green-600 dark:text-green-400 mr-2" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
      </svg>
      <p class="text-green-800 dark:text-green-200 font-medium">
        ¡Mensaje enviado correctamente! Te responderé pronto.
      </p>
    </div>
  </div>
  
  <!-- Error Message -->
  <div id="errorMessage" class="hidden mt-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg">
    <div class="flex items-center">
      <svg class="w-5 h-5 text-red-600 dark:text-red-400 mr-2" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
      </svg>
      <p id="errorText" class="text-red-800 dark:text-red-200 font-medium">
        Error al enviar el mensaje. Por favor intenta de nuevo.
      </p>
    </div>
  </div>
</div>

<script>
  function initializeContactForm() {
    const form = document.getElementById('contactForm') as HTMLFormElement;
    const submitBtn = document.getElementById('submitBtn') as HTMLButtonElement;
    const submitText = document.getElementById('submitText');
    const loadingText = document.getElementById('loadingText');
    const successMessage = document.getElementById('successMessage');
    const errorMessage = document.getElementById('errorMessage');
    const errorText = document.getElementById('errorText');

    if (!form) return;

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      // Reset messages
      successMessage?.classList.add('hidden');
      errorMessage?.classList.add('hidden');
      
      // Show loading state
      submitBtn.disabled = true;
      submitText?.classList.add('hidden');
      loadingText?.classList.remove('hidden');

      try {
        const formData = new FormData(form);
        
        const response = await fetch('/api/contact', {
          method: 'POST',
          body: formData,
        });

        const result = await response.json();

        if (result.success) {
          // Show success message
          successMessage?.classList.remove('hidden');
          form.reset();
          
          // Scroll to success message
          successMessage?.scrollIntoView({ 
            behavior: 'smooth', 
            block: 'center' 
          });
        } else {
          // Show error message
          if (errorText) {
            errorText.textContent = result.error || 'Error al enviar el mensaje';
          }
          errorMessage?.classList.remove('hidden');
          
          // Scroll to error message
          errorMessage?.scrollIntoView({ 
            behavior: 'smooth', 
            block: 'center' 
          });
        }
      } catch (error) {
        console.error('Error:', error);
        if (errorText) {
          errorText.textContent = 'Error de conexión. Por favor intenta de nuevo.';
        }
        errorMessage?.classList.remove('hidden');
        
        // Scroll to error message
        errorMessage?.scrollIntoView({ 
          behavior: 'smooth', 
          block: 'center' 
        });
      } finally {
        // Reset button state
        submitBtn.disabled = false;
        submitText?.classList.remove('hidden');
        loadingText?.classList.add('hidden');
      }
    });
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initializeContactForm);
  } else {
    initializeContactForm();
  }
</script>